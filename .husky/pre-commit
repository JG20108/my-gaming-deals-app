#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit validation..."

# Run TypeScript type checking
echo "ğŸ“‹ Checking TypeScript types..."
npm run type-check:strict

# Run ESLint
echo "ğŸ”§ Running ESLint..."
npm run lint

# Check for console.log statements
echo "ğŸš« Checking for console.log statements..."
if grep -r "console\.log" src/ --exclude-dir=node_modules; then
  echo "âŒ Found console.log statements. Please remove them before committing."
  exit 1
fi

# Check for TODO/FIXME comments
echo "ğŸ“ Checking for TODO/FIXME comments..."
TODO_COUNT=$(grep -r "TODO\|FIXME" src/ --exclude-dir=node_modules | wc -l || echo "0")
if [ "$TODO_COUNT" -gt 5 ]; then
  echo "âš ï¸ Found $TODO_COUNT TODO/FIXME comments. Consider addressing some before committing."
  grep -r "TODO\|FIXME" src/ --exclude-dir=node_modules
fi

echo "âœ… Pre-commit validation passed!" 